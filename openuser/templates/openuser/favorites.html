{% extends "base.html" %}
{% load staticfiles %}

{% block title %}Mes favoris{% endblock %}

{% block content %}

<header class="masthead text-center text-white d-flex">
        {% comment %} <div id="product-to-substitute"> {% endcomment %}
        
    {% comment %} </div> {% endcomment %}
<div id="products-list">
    <div id="products-list-head">
        <h1>Mes favoris</h1>
    </div>
{% if favorites %}
    {% for favorite in favorites %}
    <div class="product">
        <div>
            <p><strong>{{ favorite.product_name }}</strong></p>
            {% comment %} <p>Marque : {{ favorite.brand }}</p> {% endcomment %}
            {% comment %} <p>Magasin : {{ favorite.store }}</p> {% endcomment %}
            <img src={{ favorite.product_img_url }} alt="" title="" />
            {% with '/img/grade_'|add:favorite.grade|add:'.png' as grade_image %}
            <p><img class="grade" src="{% static grade_image %}" alt="{{ favorite.grade|upper }}" title="{{ favorite.grade|upper }}" /></p>
            {% endwith %}
            {% comment %} <p><a href={{ favorite.url }} target="_blank">> Voir le produit sur OFF</a></p> {% endcomment %}
            {% comment %} {% with favorite.id as id %} {% endcomment %}
            <p><a href={% url 'product_view' pk=favorite.id %} target="_blank">Â» Fiche produit</a></p>
            {% comment %} {% endwith %} {% endcomment %}
            <br>
            
            <p><button class="favorite-remove btn btn-danger" product_id={{ favorite.id }}>Retirer des favoris</button></p>
        </div>
    </div>
    
    {% endfor %}
{% else %}
    <div>
        <p>Vous n'avez pas encore de favoris</p>
    </div>
{% endif %}
    
    
</div>
</header>







{% endblock %}

{% block extra_js %}
<script type="text/javascript">
  $('.favorite-remove').click(function(){
  var product_id;
  product_id = $(this).attr("product_id");
  console.log("product_id: " + product_id);
  var favorite = $(this).closest('.product');
  console.log(favorite);
  $.ajax(
  {
      type:"GET",
      url: "http://127.0.0.1:8000/mon-espace/remove-product/" + product_id + "/",
      success: function() {
        console.log("Deleted!");
        favorite.remove();
      }
   })
});
</script>
{% endblock extra_js %}












































